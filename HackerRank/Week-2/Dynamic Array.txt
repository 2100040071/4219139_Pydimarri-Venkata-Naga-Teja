#include <stdio.h>
#include <stdlib.h>
int main() 
{
    int n, q;
    scanf("%d %d", &n, &q);
    int **lists = malloc(n * sizeof(int*));
    int *len = calloc(n, sizeof(int));
    int *capacity = calloc(n, sizeof(int));
    int lastAns = 0;
    int *results = malloc(q * sizeof(int));
    int resCount = 0;
    for (int i = 0; i < n; i++) 
    {
        lists[i] = NULL;
        capacity[i] = 0;
    }
    for (int i = 0; i < q; i++) 
    {
        int type, x, y;
        scanf("%d %d %d", &type, &x, &y);
        int index = (x ^ lastAns) % n;
        if (type == 1) 
        {
            if (len[index] == capacity[index]) 
            {
                capacity[index] = (capacity[index] == 0) ? 2 : capacity[index] * 2;
                lists[index] = realloc(lists[index], capacity[index] * sizeof(int));
            }
            lists[index][len[index]++] = y;
        } else if (type == 2) 
        {
            int val = lists[index][y % len[index]];
            lastAns = val;
            results[resCount++] = lastAns;
        }
    }
    for (int i = 0; i < resCount; i++) 
    {
        printf("%d\n", results[i]);
    }
    for (int i = 0; i < n; i++) 
    {
        free(lists[i]);
    }
    free(lists);
    free(len);
    free(capacity);
    free(results);
    return 0;
}
